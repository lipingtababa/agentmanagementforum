---
import { getCollection, render } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  const authors = await getCollection('authors');
  const authorMap = new Map(authors.map((a) => [a.id, a.data.name]));

  return articles.map((article) => ({
    params: { id: article.id },
    props: {
      article,
      authorName: authorMap.get(article.data.author.id) ?? 'Unknown',
    },
  }));
}

const { article, authorName } = Astro.props;
const { Content } = await render(article);
---

<ArticleLayout article={article} authorName={authorName}>
  <Content />
</ArticleLayout>
